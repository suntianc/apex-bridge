<!-- OPENSPEC:START -->
# OpenSpec Instructions

These instructions are for AI assistants working in this project.

Always open `@/openspec/AGENTS.md` when the request:
- Mentions planning or proposals (words like proposal, spec, change, plan)
- Introduces new capabilities, breaking changes, architecture shifts, or big performance/security work
- Sounds ambiguous and you need the authoritative spec before coding

Use `@/openspec/AGENTS.md` to learn:
- How to create and apply change proposals
- Spec format and conventions
- Project structure and guidelines

Keep this managed block so 'openspec update' can refresh the instructions.

<!-- OPENSPEC:END -->

# ApexBridge - è½»é‡çº§ABPèŠå¤©æœåŠ¡

> **é¡¹ç›®æ„¿æ™¯**: ä¸€ä¸ªä¸“æ³¨äºABPåè®®å’ŒLLMé›†æˆçš„è½»é‡çº§èŠå¤©æœåŠ¡ï¼Œæ”¯æŒå¤šLLMæä¾›å•†ã€Skillsä½“ç³»å’Œå®æ—¶æµå¼å¯¹è¯ã€‚åˆšåˆšå®Œæˆäº†ChatServiceé‡æ„ï¼Œåº”ç”¨ç­–ç•¥æ¨¡å¼å°†1406è¡Œä¸Šå¸ç±»æ‹†åˆ†ä¸º6ä¸ªé«˜å†…èšæœåŠ¡ã€‚

## ğŸ—ï¸ æ¶æ„æ€»è§ˆ

```mermaid
graph TD
    A["ApexBridge è½»é‡çº§æœåŠ¡"] --> B["æ ¸å¿ƒå¼•æ“"];
    B --> C["Protocolå¼•æ“<br/>ABPåè®®å¤„ç†"];
    B --> D["LLMç®¡ç†å™¨<br/>å¤šæä¾›å•†é€‚é…"];
    B --> E["å˜é‡å¼•æ“<br/>åŠ¨æ€å˜é‡è§£æ"];
    B --> F["Skillsä½“ç³»<br/>è½»é‡çº§æ’ä»¶"];

    A --> G["æœåŠ¡å±‚"];
    G --> H["èŠå¤©æœåŠ¡<br/>ç­–ç•¥æ¨¡å¼é‡æ„"];
    G --> I["é…ç½®æœåŠ¡<br/>åŠ¨æ€é…ç½®"];
    G --> J["LLMé…ç½®æœåŠ¡<br/>SQLiteç®¡ç†"];
    G --> K["ä¼šè¯ç®¡ç†<br/>ç”Ÿå‘½å‘¨æœŸ"];
    G --> L["è¯·æ±‚è¿½è¸ª<br/>ä¸­æ–­å¤„ç†"];

    A --> M["APIæ¥å£"];
    M --> N["èŠå¤©æ§åˆ¶å™¨<br/>OpenAIå…¼å®¹"];
    M --> O["LLMæ§åˆ¶å™¨<br/>é…ç½®ç®¡ç†"];
    M --> P["WebSocketç®¡ç†<br/>å®æ—¶é€šä¿¡"];

    A --> Q["ç­–ç•¥å±‚"];
    Q --> R["ReActç­–ç•¥<br/>å¤šè½®æ€è€ƒ"];
    Q --> S["å•è½®ç­–ç•¥<br/>å¿«é€Ÿå“åº”"];

    click C "./src/core/ProtocolEngine.ts" "æŸ¥çœ‹Protocolå¼•æ“å®ç°"
    click D "./src/core/LLMManager.ts" "æŸ¥çœ‹LLMç®¡ç†å™¨å®ç°"
    click E "./src/core/variable/VariableEngine.ts" "æŸ¥çœ‹å˜é‡å¼•æ“å®ç°"
    click H "./src/services/ChatService.ts" "æŸ¥çœ‹èŠå¤©æœåŠ¡ç­–ç•¥é‡æ„"
    click R "./src/strategies/ReActStrategy.ts" "æŸ¥çœ‹ReActç­–ç•¥å®ç°"
    click S "./src/strategies/SingleRoundStrategy.ts" "æŸ¥çœ‹å•è½®ç­–ç•¥å®ç°"
```

## ğŸ“¦ æ ¸å¿ƒæ¨¡å—

| æ¨¡å— | è·¯å¾„ | èŒè´£ | çŠ¶æ€ |
|------|------|------|------|
| **æ ¸å¿ƒå¼•æ“** | `src/core/` | ABPåè®®ã€LLMç®¡ç†ã€å˜é‡å¼•æ“ã€Skillsä½“ç³» | âœ… æ´»è·ƒ |
| **èŠå¤©æœåŠ¡** | `src/services/ChatService.ts` | ç­–ç•¥æ¨¡å¼é‡æ„ï¼Œæ”¯æŒReActå’Œå•è½®ç­–ç•¥ | âœ… é‡æ„å®Œæˆ |
| **APIå±‚** | `src/api/` | èŠå¤©æ¥å£ã€LLMé…ç½®ã€WebSocketé€šä¿¡ | âœ… æ´»è·ƒ |
| **ç­–ç•¥å±‚** | `src/strategies/` | ReActå¤šè½®æ€è€ƒå’Œå•è½®å¿«é€Ÿå“åº”ç­–ç•¥ | âœ… æ–°å¢ |
| **LLMé…ç½®** | `src/services/LLMConfigService.ts` | SQLiteå­˜å‚¨å¤šæä¾›å•†é…ç½® | âœ… æ´»è·ƒ |
| **ä¼šè¯ç®¡ç†** | `src/services/SessionManager.ts` | å¯¹è¯ç”Ÿå‘½å‘¨æœŸå’Œå…ƒæ•°æ®ç®¡ç† | âœ… æ–°å¢ |

## ğŸš€ è¿è¡Œä¸å¼€å‘

### ğŸ“‹ ç¯å¢ƒè¦æ±‚
- **Node.js** â‰¥ 16.0.0
- **npm** â‰¥ 8.0.0 æˆ– **yarn** â‰¥ 1.22.0
- **Git** ï¼ˆç‰ˆæœ¬æ§åˆ¶ï¼‰

### âš¡ å¿«é€Ÿå¼€å§‹
```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/your-username/apex-bridge.git
cd apex-bridge

# 2. æ›´æ–°å¾½ç« é…ç½®ï¼ˆæ›¿æ¢ä¸ºä½ çš„GitHubç”¨æˆ·åï¼‰
./scripts/update-badges.sh your-username

# 3. å®‰è£…æ‰€æœ‰æ¨¡å—ä¾èµ–
npm run install:all

# 4. é…ç½®ç¯å¢ƒå˜é‡
cp apex-bridge/env.template .env
# ç¼–è¾‘ .env æ–‡ä»¶é…ç½®LLMæä¾›å•†APIå¯†é’¥

# 5. å¼€å‘æ¨¡å¼
npm run dev
```

### ğŸ“¦ ä¾èµ–ç®¡ç†
```bash
# å®‰è£…æ‰€æœ‰æ¨¡å—ä¾èµ–
npm run install:all

# æ›´æ–°æ‰€æœ‰æ¨¡å—ä¾èµ–
npm run update:all

# æ£€æŸ¥ä¾èµ–å®‰å…¨
npm run audit:all
```

## ğŸ”§ æ ¸å¿ƒæ¶æ„ç‰¹è‰²

### ğŸ§  ChatServiceç­–ç•¥é‡æ„ï¼ˆ2025-11-30æ›´æ–°ï¼‰
- **ç­–ç•¥æ¨¡å¼**: å°†1406è¡Œä¸Šå¸ç±»æ‹†åˆ†ä¸º6ä¸ªé«˜å†…èšæœåŠ¡
- **ReActç­–ç•¥**: æ”¯æŒå¤šè½®æ€è€ƒå’Œå·¥å…·è°ƒç”¨çš„å¤æ‚å¯¹è¯
- **å•è½®ç­–ç•¥**: å¿«é€Ÿå“åº”çš„ç®€å•å¯¹è¯æ¨¡å¼
- **æœåŠ¡æ‹†åˆ†**: ChatServiceã€SessionManagerã€RequestTrackerã€VariableResolverã€AceIntegratorã€ConversationHistoryService

### ğŸ§  ABPåè®®å¼•æ“ï¼ˆABP-onlyï¼‰
- **ç‹¬ç«‹å®ç°**: ä¸å†ä¾èµ–ä»»ä½•å¤–éƒ¨SDKï¼Œå®Œå…¨è‡ªä¸»çš„ABPåè®®å¤„ç†
- **Skillsä½“ç³»**: å–ä»£ä¼ ç»Ÿæ’ä»¶ï¼Œæ”¯æŒä¸¤æ®µæ‰§è¡Œå™¨ï¼ˆDirect/Internalï¼‰
- **å˜é‡è§£æ**: æ”¯æŒæ—¶é—´ã€ç¯å¢ƒã€å ä½ç¬¦ç­‰å¤šç§å˜é‡ç±»å‹
- **å·¥å…·æè¿°**: åŠ¨æ€ç”Ÿæˆå·¥å…·æè¿°ï¼Œç®€åŒ–å·¥å…·è°ƒç”¨æµç¨‹

### ğŸ¯ å¤šLLMæ”¯æŒ
- **é€‚é…å™¨æ¨¡å¼**: ç»Ÿä¸€æ¥å£æ”¯æŒOpenAIã€DeepSeekã€æ™ºè°±ã€Ollamaç­‰
- **SQLiteé…ç½®**: ä»æ•°æ®åº“åŠ è½½é…ç½®ï¼Œæ”¯æŒè¿è¡Œæ—¶çƒ­æ›´æ–°
- **æ™ºèƒ½é‡è¯•**: è‡ªåŠ¨é‡è¯•æœºåˆ¶ï¼Œæ”¯æŒæŒ‡æ•°é€€é¿
- **æµå¼å“åº”**: æ”¯æŒæµå¼èŠå¤©å’Œå®æ—¶ä¸­æ–­

### ğŸ” å®‰å…¨ä¸ç›‘æ§
- **å¤šå±‚è®¤è¯**: API Keyè®¤è¯æœºåˆ¶
- **é€Ÿç‡é™åˆ¶**: æ™ºèƒ½é™æµï¼Œæ”¯æŒIPå’ŒAPI KeyåŒé‡ç­–ç•¥
- **å®‰å…¨ä¸­é—´ä»¶**: è¾“å…¥æ¸…ç†ã€è·¯å¾„éå†é˜²æŠ¤ã€å®‰å…¨æ—¥å¿—è®°å½•
- **å®æ—¶é€šä¿¡**: WebSocketæ”¯æŒåŒå‘é€šä¿¡å’Œè¯·æ±‚ä¸­æ–­

### ğŸ§ª æ–°å¢æœåŠ¡ç»„ä»¶
- **ä¼šè¯ç®¡ç†å™¨**: ç®¡ç†å¯¹è¯ç”Ÿå‘½å‘¨æœŸå’Œå…ƒæ•°æ®
- **è¯·æ±‚è¿½è¸ªå™¨**: è·Ÿè¸ªæ´»åŠ¨è¯·æ±‚ï¼Œæ”¯æŒä¸­æ–­å¤„ç†
- **å˜é‡è§£æå™¨**: å¤„ç†æ¶ˆæ¯ä¸­çš„åŠ¨æ€å˜é‡
- **ACEé›†æˆå™¨**: é›†æˆACEå¼•æ“çš„è½¨è¿¹è®°å½•

## ğŸ§ª æµ‹è¯•ç­–ç•¥

### æµ‹è¯•å±‚çº§
1. **å•å…ƒæµ‹è¯•** - æ ¸å¿ƒå¼•æ“å’ŒæœåŠ¡å±‚ï¼ˆJestï¼‰
2. **é›†æˆæµ‹è¯•** - APIæ¥å£å’ŒWebSocket
3. **ç«¯åˆ°ç«¯æµ‹è¯•** - å®Œæ•´ç”¨æˆ·åœºæ™¯

### è¿è¡Œæµ‹è¯•
```bash
# åœ¨ä¸»ç›®å½•è¿è¡Œæ‰€æœ‰æµ‹è¯•
cd apex-bridge
npm test

# è¦†ç›–ç‡æŠ¥å‘Š
npm run test:coverage

# ç‰¹å®šæµ‹è¯•
npm test -- ReActStrategy.test.ts
```

### æµ‹è¯•è¦†ç›–é‡ç‚¹
- ABPåè®®å˜é‡è§£æä¸Skillsæ‰§è¡Œ
- å¤šLLMæä¾›å•†é€‚é…å’Œåˆ‡æ¢
- WebSocketè¿æ¥å’Œæ¶ˆæ¯å¤„ç†
- ç­–ç•¥æ¨¡å¼çš„ä¸åŒæ‰§è¡Œè·¯å¾„
- è¯·æ±‚ä¸­æ–­å’Œæµå¼å“åº”æœºåˆ¶

## ğŸ“‹ ç¼–ç è§„èŒƒ

### TypeScriptè§„èŒƒ
- ä¸¥æ ¼æ¨¡å¼å¯ç”¨ (`strict: true`)
- æ˜ç¡®çš„ç±»å‹å®šä¹‰å’Œæ¥å£è®¾è®¡
- å‡½æ•°å¼ç¼–ç¨‹ä¼˜å…ˆï¼Œç±»ç”¨äºæ˜ç¡®æŠ½è±¡
- é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•æ ‡å‡†åŒ–

### é¡¹ç›®ç»“æ„è§„èŒƒ
```
apex-bridge/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ core/           # æ ¸å¿ƒå¼•æ“ï¼ˆProtocolã€LLMã€å˜é‡ã€Skillsç­‰ï¼‰
â”‚   â”œâ”€â”€ services/       # ä¸šåŠ¡é€»è¾‘æœåŠ¡ï¼ˆChatServiceç­–ç•¥é‡æ„ï¼‰
â”‚   â”œâ”€â”€ strategies/     # èŠå¤©ç­–ç•¥ï¼ˆReActå’Œå•è½®ç­–ç•¥ï¼‰
â”‚   â”œâ”€â”€ api/            # APIæ¥å£å’Œæ§åˆ¶å™¨
â”‚   â”œâ”€â”€ types/          # ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ utils/          # å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ config/         # é…ç½®ç®¡ç†
â”œâ”€â”€ tests/              # æµ‹è¯•å¥—ä»¶
â”œâ”€â”€ config/             # é…ç½®æ–‡ä»¶
â””â”€â”€ docs/               # æ–‡æ¡£
```

### å‘½åçº¦å®š
- **ç±»å**: PascalCase (å¦‚: `ProtocolEngine`, `LLMManager`)
- **å‡½æ•°å’Œå˜é‡**: camelCase (å¦‚: `loadConfig`, `systemPrompt`)
- **å¸¸é‡**: UPPER_SNAKE_CASE (å¦‚: `DEFAULT_TIMEOUT`, `MAX_RETRIES`)
- **æ–‡ä»¶å’Œç›®å½•**: kebab-case (å¦‚: `protocol-engine.ts`, `chat-controller.ts`)

## ğŸ¤– AI ä½¿ç”¨æŒ‡å¼•

### æ ¸å¿ƒå¼•æ“ç†è§£è·¯å¾„
1. **ProtocolEngine** (`src/core/ProtocolEngine.ts`)
   - ç‹¬ç«‹å®ç°ï¼Œä¸å†ä¾èµ–ä»»ä½•å¤–éƒ¨SDK
   - å¤„ç†ABPåè®®è§£æå’Œå·¥å…·è°ƒç”¨ï¼ˆç»Skillsæ˜ å°„æ‰§è¡Œï¼‰
   - å¤„ç†å˜é‡è§£æä¸å·¥å…·æè¿°ç”Ÿæˆ
   - è½»é‡çº§è®¾è®¡ï¼Œä¸“æ³¨äºæ ¸å¿ƒèŠå¤©åŠŸèƒ½

2. **LLMManager** (`src/core/LLMManager.ts`)
   - å¤šæä¾›å•†é€‚é…å™¨æ¨¡å¼
   - æ”¯æŒOpenAIã€DeepSeekã€æ™ºè°±ã€Ollama
   - æµå¼èŠå¤©å’Œé‡è¯•æœºåˆ¶
   - ä¸ProtocolEngineæ·±åº¦é›†æˆ

3. **ChatServiceç­–ç•¥é‡æ„** (`src/services/ChatService.ts`)
   - åº”ç”¨ç­–ç•¥æ¨¡å¼æ‹†åˆ†ä¸Šå¸ç±»
   - æ”¯æŒReActå¤šè½®æ€è€ƒå’Œå•è½®å¿«é€Ÿå“åº”
   - 6ä¸ªé«˜å†…èšæœåŠ¡ååŒå·¥ä½œ
   - ä¼šè¯ç®¡ç†å’Œè¯·æ±‚è¿½è¸ªé›†æˆ

### Skills å¼€å‘æŒ‡å—
1. **ç›®å½•ç»“æ„**
   - `SKILL.md`ï¼šå‰è¨€åŒºå«ABPé…ç½®ï¼ˆtools/kind/parametersï¼‰ï¼Œæ­£æ–‡æä¾›æ‰§è¡ŒæŒ‡ä»¤ä¸æ³¨æ„äº‹é¡¹
   - `scripts/execute.ts`ï¼šæŠ€èƒ½æ‰§è¡Œå…¥å£ï¼ˆé»˜è®¤å¯¼å‡ºï¼‰
   - `references/`ã€`assets/`ï¼šå‚è€ƒèµ„æ–™ä¸èµ„æº

2. **æŠ€èƒ½æ‰§è¡Œç±»å‹**
   - **Directï¼ˆç›´æ¥æ‰§è¡Œï¼‰**: æœ¬åœ°åŒæ­¥æ‰§è¡Œï¼Œé»˜è®¤ç±»å‹
   - **Internalï¼ˆå†…éƒ¨æ‰§è¡Œï¼‰**: æ ¸å¿ƒç³»ç»Ÿå†…ç½®æŠ€èƒ½
   - ç®€åŒ–çš„æ‰§è¡Œæ¨¡å‹ï¼Œä¸“æ³¨äºè½»é‡çº§åœºæ™¯

### ç­–ç•¥æ¨¡å¼æ‰©å±•
```typescript
// 1. åˆ›å»ºæ–°ç­–ç•¥
// src/strategies/NewStrategy.ts
export class NewStrategy implements ChatStrategy {
  supports(options: ChatOptions): boolean {
    // åˆ¤æ–­æ˜¯å¦æ”¯æŒè¯¥é€‰é¡¹
  }

  async execute(messages: Message[], options: ChatOptions): Promise<ChatResult> {
    // å®ç°ç­–ç•¥é€»è¾‘
  }
}

// 2. æ³¨å†Œåˆ°ChatService
// src/services/ChatService.ts æ„é€ å‡½æ•°ä¸­
this.strategies = [
  new ReActStrategy(...),
  new SingleRoundStrategy(...),
  new NewStrategy(...) // æ·»åŠ æ–°ç­–ç•¥
];
```

## ğŸ“Š å˜æ›´è®°å½• (Changelog)

### 2025-11-30 - ChatServiceç­–ç•¥é‡æ„å®Œæˆ
- âœ… **ç­–ç•¥æ¨¡å¼é‡æ„**: å°†1406è¡Œä¸Šå¸ç±»æ‹†åˆ†ä¸º6ä¸ªé«˜å†…èšæœåŠ¡
  - ChatService: ä¸»æœåŠ¡åè°ƒï¼ˆ~200è¡Œï¼‰
  - SessionManager: ä¼šè¯ç”Ÿå‘½å‘¨æœŸç®¡ç†
  - RequestTracker: æ´»åŠ¨è¯·æ±‚è¿½è¸ªå’Œä¸­æ–­å¤„ç†
  - VariableResolver: åŠ¨æ€å˜é‡è§£æï¼ˆ30ç§’ç¼“å­˜ï¼‰
  - AceIntegrator: ACEå¼•æ“è½¨è¿¹é›†æˆ
  - ConversationHistoryService: å¯¹è¯å†å²ç®¡ç†

- âœ… **æ–°å¢ç­–ç•¥å±‚**: åˆ›å»ºç‹¬ç«‹çš„ç­–ç•¥æ¨¡å¼å®ç°
  - ChatStrategyæ¥å£: å®šä¹‰ç­–ç•¥å¥‘çº¦
  - ReActStrategy: å¤šè½®æ€è€ƒå’Œå·¥å…·è°ƒç”¨
  - SingleRoundStrategy: å¿«é€Ÿå•è½®å“åº”

- âœ… **æ¶æ„ä¼˜åŒ–**: æœåŠ¡èŒè´£æ¸…æ™°åˆ†ç¦»
  - ç­–ç•¥é€‰æ‹©é€»è¾‘: æ ¹æ®options.selfThinking.enabledè‡ªåŠ¨é€‰æ‹©
  - æµå¼æ”¯æŒ: ä¸¤ç§ç­–ç•¥éƒ½æ”¯æŒæµå¼è¾“å‡º
  - ACEé›†æˆ: ç»Ÿä¸€çš„è½¨è¿¹è®°å½•å’Œä¼šè¯ç®¡ç†

- âœ… **ä»£ç è´¨é‡æå‡**:
  - å¹³å‡æ¯ä¸ªæœåŠ¡<300è¡Œä»£ç 
  - é«˜å†…èšä½è€¦åˆè®¾è®¡
  - å®Œæ•´çš„TypeScriptç±»å‹æ”¯æŒ

### 2025-11-19 - æ¶æ„ç®€åŒ–ä¸ä»£ç æ¸…ç†
- âœ… **ä¸­é—´ä»¶ç®€åŒ–**: 7ä¸ªä¸­é—´ä»¶æ–‡ä»¶ç®€åŒ–ï¼Œå¹³å‡å‡å°‘53.4%ä»£ç é‡
  - rateLimitMiddleware: 673â†’374è¡Œ (-44.4%)
  - validationMiddleware: 414â†’167è¡Œ (-59.4%)
  - auditLoggerMiddleware: 250â†’67è¡Œ (-73.2%)
  - sanitizationMiddleware: 302â†’134è¡Œ (-55.6%)
  - securityLoggerMiddleware: 233â†’105è¡Œ (-54.9%)
  - customValidators: 171â†’62è¡Œ (-63.7%)
  - validationSchemas: 224â†’172è¡Œ (-23.2%)

- âœ… **Servicesç²¾ç®€**: ç§»é™¤4ä¸ªè¿‡åº¦è®¾è®¡çš„æœåŠ¡ï¼Œç®€åŒ–ConfigService
  - åˆ é™¤: DiaryArchiveService, SecurityAlertService, SecurityStatsService
  - ç®€åŒ–: ConfigService 1005â†’470è¡Œ (-53.2%)
  - åˆ é™¤: RaceDetector, TransactionManager, Mutexç­‰å¹¶å‘å·¥å…·
  - æ€»è®¡å‡å°‘: ~1,300è¡Œä»£ç 

- âœ… **Typesä¼˜åŒ–**: ç§»é™¤æœªä½¿ç”¨çš„ç±»å‹å®šä¹‰
  - åˆ é™¤: personality.ts (51è¡Œ)
  - ç®€åŒ–: index.ts ç§»é™¤äº†LLMQuotaConfigç­‰æœªä½¿ç”¨ç±»å‹
  - ç®€åŒ–: skills.ts SkillExecutionTypeä»6ç§å‡å°‘åˆ°2ç§
  - æ€»è®¡å‡å°‘: ~288è¡Œä»£ç 

- âœ… **åŠŸèƒ½æ¸…ç†**: ç§»é™¤éæ ¸å¿ƒåŠŸèƒ½
  - åˆ é™¤: plugin-callback.ts (å¼‚æ­¥æ’ä»¶å›è°ƒ)
  - åˆ é™¤: AsyncResultProvideråŠç›¸å…³æœåŠ¡
  - åˆ é™¤: DemoAsyncTaskæŠ€èƒ½ç¤ºä¾‹
  - æ€»è®¡å‡å°‘: ~600è¡Œä»£ç 

- âœ… **æ¶æ„ç®€åŒ–æˆæœ**:
  - **æ€»ä»£ç å‡å°‘**: ~2,200+è¡Œï¼ˆä»å¤æ‚åˆ†å¸ƒå¼ç³»ç»Ÿç®€åŒ–ä¸ºè½»é‡çº§ABPèŠå¤©æœåŠ¡ï¼‰
  - **ç¼–è¯‘çŠ¶æ€**: âœ… å…¨éƒ¨é€šè¿‡
  - **æ¶æ„æ¸…æ™°**: ä¸“æ³¨äºæ ¸å¿ƒèŠå¤©åŠŸèƒ½ï¼Œå»é™¤è¿‡åº¦å·¥ç¨‹åŒ–è®¾è®¡

### 2025-11-16 - é¡¹ç›®åˆå§‹åŒ–æ‰«æ
- âœ… å®Œæˆé¡¹ç›®ç»“æ„åˆ†æå’Œæ¨¡å—è¯†åˆ«
- âœ… åˆ†ææ ¸å¿ƒæ¶æ„ï¼šABPåè®®å¼•æ“ã€Skillsä½“ç³»ã€å¤šLLMæ”¯æŒ
- âœ… è¯†åˆ«å…³é”®ç»„ä»¶ï¼šäººæ ¼å¼•æ“ã€æƒ…æ„Ÿå¼•æ“ã€è®°å¿†ç³»ç»Ÿã€åˆ†å¸ƒå¼èŠ‚ç‚¹
- âœ… å»ºç«‹æ¨¡å—æ–‡æ¡£ä½“ç³»æ¡†æ¶
- âœ… ç”Ÿæˆæ¶æ„å›¾å’Œæ¨¡å—ç´¢å¼•

### æ‰«æè¦†ç›–ç‡ï¼ˆå½“å‰ï¼‰
- **æ€»æ–‡ä»¶æ•°**: ~89ä¸ªæ–‡ä»¶ï¼ˆç²¾ç®€åæ¶æ„ï¼‰
- **æ ¸å¿ƒä»£ç **: ç»“æ„æ¸…æ™°ï¼Œæ¨¡å—èŒè´£æ˜ç¡®
- **æ¶æ„çŠ¶æ€**: è½»é‡çº§ã€ä¸“æ³¨ã€æ˜“ç»´æŠ¤
- **ç­–ç•¥é‡æ„**: å®ŒæˆChatServiceç­–ç•¥æ¨¡å¼æ‹†åˆ†

## ğŸ¯ å½“å‰æ¶æ„ç‰¹ç‚¹

### âœ… ä¿ç•™çš„æ ¸å¿ƒåŠŸèƒ½
1. **ProtocolEngine** - ABPåè®®å¤„ç†æ ¸å¿ƒ
2. **LLMManager** - å¤šLLMæä¾›å•†æ”¯æŒ
3. **VariableEngine** - å˜é‡è§£æç³»ç»Ÿ
4. **ChatService** - ç­–ç•¥æ¨¡å¼é‡æ„çš„èŠå¤©æœåŠ¡
5. **Skillsä½“ç³»** - ç®€åŒ–çš„æŠ€èƒ½æ‰§è¡Œï¼ˆDirect/Internalï¼‰
6. **WebSocket** - å®æ—¶é€šä¿¡
7. **LLMConfigService** - LLMé…ç½®ç®¡ç†

### ğŸ†• æ–°å¢ç­–ç•¥æ¨¡å¼
1. **ChatStrategyæ¥å£** - ç»Ÿä¸€çš„ç­–ç•¥å¥‘çº¦
2. **ReActStrategy** - æ”¯æŒå¤šè½®æ€è€ƒå’Œå·¥å…·è°ƒç”¨
3. **SingleRoundStrategy** - å¿«é€Ÿå•è½®å“åº”
4. **æœåŠ¡æ‹†åˆ†** - 6ä¸ªé«˜å†…èšçš„ç‹¬ç«‹æœåŠ¡

### ğŸ¯ è®¾è®¡ç†å¿µ
- **KISSåŸåˆ™**: ä¿æŒç®€å•ï¼Œä¸“æ³¨äºæ ¸å¿ƒèŠå¤©åŠŸèƒ½
- **YAGNIåŸåˆ™**: ç§»é™¤å½“å‰ä¸éœ€è¦çš„å¤æ‚åŠŸèƒ½
- **ç­–ç•¥æ¨¡å¼**: æ ¹æ®ä¸åŒåœºæ™¯é€‰æ‹©æœ€ä¼˜å¤„ç†ç­–ç•¥
- **å•ä¸€èŒè´£**: æ¯ä¸ªæœåŠ¡èŒè´£æ¸…æ™°ï¼Œä¾¿äºç»´æŠ¤
- **ç±»å‹å®‰å…¨**: ä¸¥æ ¼çš„TypeScriptç±»å‹å®šä¹‰
- **ç¼–è¯‘é€šè¿‡**: æ‰€æœ‰é‡æ„éƒ½ä¿è¯ç¼–è¯‘æˆåŠŸ

---

**æ›´æ–°æ—¶é—´**: 2025-11-30 18:21:54
**æ‰«æè¦†ç›–**: 25/89æ–‡ä»¶ (28.1%)
**æ¶æ„çŠ¶æ€**: ç­–ç•¥é‡æ„å®Œæˆï¼Œä»£ç è´¨é‡æ˜¾è‘—æå‡