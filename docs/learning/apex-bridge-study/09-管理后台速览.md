# 09 - 管理后台速览

管理后台位于 `admin/` 目录，是运维 Apex Bridge 的可视化入口。基于 React 18 + Vite + shadcn/ui + Zustand 构建，提供系统状态监控、节点管理、配置编辑与日志查看等功能。

## 9.1 技术栈与工程结构
- **构建工具**：Vite 负责开发构建；配置集中在 `vite.config.ts` 与 `tsconfig.json`。
- **组件体系**：UI 采用 shadcn/ui 组件库，结合 Tailwind CSS；`src/components` 存放通用组件，`src/pages` 对应路由页面。
- **状态管理**：Zustand 管理全局状态（例如用户信息、节点列表、配置草稿）；同时使用 React Query 或自定义 Hook 处理数据拉取与缓存。
- **类型共享**：通过 TypeScript path alias 引入主项目的类型定义（如节点信息、配置接口），保证前后端一致。
- **国际化支持**：可结合 `i18next` 等库加载多语言文案，目录位于 `src/locales`（若启用）。

## 9.2 核心页面说明
- **仪表盘（Dashboard）**：展示系统实时状态，包括在线节点数、任务成功率、主动提醒统计、LLM 调用情况。
- **节点管理**：列表、筛选、详情查看、手动上下线、查看心跳与资源占用；支持实时图表和历史记录对比。
- **配置中心**：读写 Hub 配置（人格、主动场景、插件开关、记忆模式等），通过 RuntimeConfigService 与后端交互，提供差异比较与回滚操作。
- **日志与告警**：订阅 WebSocket 推送的事件，展示告警、插件执行日志、节点异常；可手动确认或导出。
- **任务中心（可选）**：显示异步任务列表，标记成功、失败、重试次数。

## 9.3 前后端交互
- **API 调用**：通过 Axios 或 Fetch 封装请求，与 Hub 的 `/v1/config/*`、`/v1/nodes/*`、`/v1/logs/*` 等接口通信。
- **WebSocket 订阅**：使用封装的 `useWebSocketChannel` Hook 连接 WebSocketManager，接收 `notification`、`alert`、`node.statusChange` 等消息。
- **表单与校验**：配置编辑前会在前端进行模式校验（基于 Zod 或 Yup），提交后由后台再做一次校验并落盘。
- **审计链路**：操作成功后，会在前端提示并记录审计日志 ID，便于回溯。

## 9.4 设计要点
- **信息分层**：首页聚焦关键健康指标；详细信息放在子页或抽屉中，避免信息过载。
- **实时反馈**：对节点状态、主动提醒使用可视化标签（online/offline/busy），支持秒级刷新或 WebSocket 推送。
- **安全性**：前端需遵循权限策略隐藏敏感操作；对于配置修改，提供二次确认与差异预览。
- **主题与可访问性**：shadcn/ui 支持暗色/亮色主题切换；注意按钮对比度、键盘可导航性。

## 9.5 运维工作流示例
1. 管理员登录后台，通过仪表盘检查节点在线率与任务成功率。
2. 在节点管理中查看心跳异常的节点，查看详情并尝试远程下线或通知维护者。
3. 转到配置中心，调整 Proactivity 配置或插件白名单，提交后查看审计日志。
4. 在日志页面监控近期告警，对异常任务执行重试或标记已知问题。
5. 导出系统运行报告，与家庭成员或运维团队共享。

管理后台通过统一的可视化入口，让运维人员无需直接修改配置文件即可管理整个家庭 AI 系统，同时确保与 Hub 的 API、WebSocket 通道保持实时同步。

